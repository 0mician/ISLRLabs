#+TITLE: Statistical methods for bioinformatics \linebreak Beyond linearity: case study (de Vijver et al.)
#+AUTHOR: Cedric Lood
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [11pt, a4paper]
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LATEX_HEADER: \usepackage[english]{babel}
#+LATEX_HEADER: \usepackage{graphicx}
#+LATEX_HEADER: \usepackage[left=2.35cm, right=3.35cm, top=3.35cm, bottom=3.0cm]{geometry}
#+LATEX_HEADER: \usepackage{titling}

#+BEGIN_LaTeX
\graphicspath{ {figures/} }
\setlength{\droptitle}{-5em} 
\setlength{\parindent}{0cm}
#+END_LaTeX
#+OPTIONS: LaTeX:dvipng, toc:nil

* Exercise 1
** Part a
This is straightforward by taking the coefficients $a_1=\beta_0,
b_1=\beta_1, c_1=\beta_2, d_1=\beta_3$
** Part b
Since we are looking at $x>\xi$, we have the form:

- $f(x)=\beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \beta_4 (x - \xi)^3$

We can distribute the cube and get:

- $f(x)=\beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \beta_4 (x^3 - 3 x^2 \xi + 3 x \xi^2 - \xi^3)$

The expression can be re-arranged to highlight the predictors
coefficients' values:
 
- $f(x)=(\beta_0 - \beta_4 \xi^3) + (\beta_1 + 3 \beta_4 \xi^2) x +(\beta_2 - 3 \beta_4 \xi) x^2 + (\beta_3 + \beta_4) x^3$

Combining with the answer of Part a, we now see that $f(x)$ is a
piecewise polynomial
** Part c

Showing that the 2 pieces are connected continuously can be done by
solving both in $\xi$:

- $f_1(\xi)=\beta_0 + \beta_1 \xi + \beta_2 \xi^2 + \beta_3 \xi^3$
- $f_2(\xi)=(\beta_0 - \beta_4 \xi^3) + (\beta_1 + 3 \beta_4 \xi^2) \xi  +(\beta_2 - 3 \beta_4 \xi) \xi^2 + (\beta_3 + \beta_4) \xi^3$

When distributing the terms in $f_2(\xi)$, one obtains that the terms
in $\beta_4$ cancel each other, and that $f_2(\xi)=\beta_0 + \beta_1 \xi + \beta_2 \xi^2 + \beta_3 \xi^3=f_1(\xi)$
** Part d
For this, we need the first order derivatives of $f_1(x)$ and $f_2(x)$
- $f_1'(x)=\beta_1 + 2\beta_2 x + 3\beta_3 x^2$
- $f_2'(x)=\beta_1 + 3 \beta_4 x^2 + 2 (\beta_2 - 3 \beta_4 x) x + 3 (\beta_3 + \beta_4) x^2$

Solving the equations above for $x=\xi$:

- $f_1'(\xi)=\beta_1 + 2\beta_2 \xi + 3\beta_3 \xi^2$
- $f_2'(\xi) = \beta_1 + 3\beta_4 \xi^2 + 2(\beta_2 - 3\beta_4 \xi) \xi + 3(\beta_3 + \beta_4) \xi^2$
- $f_2'(\xi) = \beta_1 + 3\beta_4 \xi^2 + 2\beta_2 \xi - 6\beta_4 \xi^2 + 3\beta_3 \xi^2 + 3\beta_4 \xi^2$
- $f_2'(\xi) = \beta_1 + 2\beta_2 \xi + 3\beta_3 \xi^2 + 3\beta_4 \xi^2 + 3\beta_4 \xi^2 - 6\beta_4 \xi^2$
- $f_2'(\xi) = \beta_1 + 2\beta_2 \xi + 3\beta_3 \xi^2$

Hence, $f_1'(\xi)=\beta_1 + 2\beta_2 \xi + 3\beta_3 \xi^2=f_2'(\xi)$
** Part e
We can take the second order derivatives of $f_1(x)$ and $f_2(x)$,
and solve in $\xi$ to verify if the transition is continuous:

- $f_1''(x) = 2\beta_2 + 6\beta_3 x$
- $f_2''(x) = 2(\beta_2 - 3\beta_4 x) + 6(\beta_3 + \beta_4) x = 2\beta_2 + 6\beta_3 x$

Hence, $f_1''(\xi) = 2\beta_2 + 6\beta_3 \xi=f_2''(x)$ \\

Combining this with the previous parts, we have shown that $f(x)$ is
indeed a cubic spline, where the piecewise functions $f_1(x)$ and
$f_2(x)$ are indeed connected, and where the first order and second
order derivatives are smoothly connected.

* Exercise 9
** part a
** part b
** part c
** part d
** part e
** part f
* templates                                                        :noexport:

#+BEGIN_SRC R
#+END_SRC

#+BEGIN_EXAMPLE
#+END_EXAMPLE

#+BEGIN_LaTeX
\includegraphics[scale=0.4]{graph.pdf}
#+END_LaTeX

